default: all

# What to build

FILES := \
error1a.v \
error1b.v \
error1c.v \
sub.v \
werror.v \
include.v \

# Build options

VP3_OPTS := -y .

# these tests don't produce proper output
TOP :=

# Build exceptions

werror.v: VP3_OPTS += -w

sub.v: VP3_SHOULD_FAIL :=

# Dependencies

error1.v: sub.v

error1a.v: sub.v

error1b.v: sub.v

error1c.v: sub.v

VP3_SHOULD_FAIL := 1
VP3_DIFF_OUTPUT :=

# Special tests for pass1out handling

.PHONY: error1a.vp error1b.vp error1c.vp

# Check that we overwrite previous output
error1a.vp:
	cp error1.vp $@
	echo "// Generated by vp3" > error1a.v.preprocessed

# Check that we don't overwrite random files
error1b.vp:
	cp error1.vp $@
	echo "Not vp3 output" > error1b.v.preprocessed

# Check that we save preprocessor output if the file doesn't exist
error1c.vp:
	cp error1.vp $@
	rm -f error1c.v.preprocessed

include ../rules.make
